<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> SAML is insecure by design | joonas.fi</title>
  <meta name="description" content="Let’s get to work ᕕ( ᐛ )ᕗ">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="SAML is insecure by design" />
<meta property="og:description" content="What is SAML? Security Assertion Markup Language (SAML) is an open standard for exchanging authentication and authorization data between parties.
Source: Wikipedia
SAML is often used for single-sign on (&ldquo;Sign in with Google&rdquo;, &ldquo;Sign in with Twitter&rdquo; etc.). It means when you want to log in to example.com, example.com can trust &amp; use an external authentication provider to assert the user&rsquo;s identity for you. SAML is about communicating these authentication &amp; identity details across organization boundaries (web domains)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://tunacici.com/blog/2021/08/saml-is-insecure-by-design/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-03T12:15:00+00:00" />
<meta property="article:modified_time" content="2021-08-03T12:15:00+00:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SAML is insecure by design"/>
<meta name="twitter:description" content="What is SAML? Security Assertion Markup Language (SAML) is an open standard for exchanging authentication and authorization data between parties.
Source: Wikipedia
SAML is often used for single-sign on (&ldquo;Sign in with Google&rdquo;, &ldquo;Sign in with Twitter&rdquo; etc.). It means when you want to log in to example.com, example.com can trust &amp; use an external authentication provider to assert the user&rsquo;s identity for you. SAML is about communicating these authentication &amp; identity details across organization boundaries (web domains)."/>

  
  
  
  <link rel="stylesheet" href="/blog/css/style-white.css">
  
   <link rel="stylesheet" href="/blog/css/custom.css"> 
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  <link rel="icon" type="image/png" href="/favicon.ico" />
  
  
  
  
  
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-24122659-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/blog/">Home</a></li>
         
        <li><a href="/blog/today-i-learned/">Today I Learned</a></li>
         
        <li><a href="/blog/about/">About</a></li>
         
        <li><a href="/blog/contact/">Contact</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://tunacici.com/blog/2021/07/stable-device-path-for-linux-hwmon-interfaces/">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://tunacici.com/blog/today-i-learned/2022/file-copy-progress-for-any-running-process/">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&text=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&title=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&is_video=false&description=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=SAML%20is%20insecure%20by%20design&body=Check out this article: https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&title=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&title=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&title=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-stumbleupon " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&title=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-digg " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&name=SAML%20is%20insecure%20by%20design&description=What%20is%20SAML%3f%20Security%20Assertion%20Markup%20Language%20%28SAML%29%20is%20an%20open%20standard%20for%20exchanging%20authentication%20and%20authorization%20data%20between%20parties.%0aSource%3a%20Wikipedia%0aSAML%20is%20often%20used%20for%20single-sign%20on%20%28%26ldquo%3bSign%20in%20with%20Google%26rdquo%3b%2c%20%26ldquo%3bSign%20in%20with%20Twitter%26rdquo%3b%20etc.%29.%20It%20means%20when%20you%20want%20to%20log%20in%20to%20example.com%2c%20example.com%20can%20trust%20%26amp%3b%20use%20an%20external%20authentication%20provider%20to%20assert%20the%20user%26rsquo%3bs%20identity%20for%20you.%20SAML%20is%20about%20communicating%20these%20authentication%20%26amp%3b%20identity%20details%20across%20organization%20boundaries%20%28web%20domains%29.">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&t=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-saml">What is SAML?</a></li>
    <li><a href="#why-should-i-care">Why should I care?</a></li>
    <li><a href="#why-is-saml-insecure">Why is SAML insecure?</a></li>
    <li><a href="#why-is-signing-computed-values-dangerous">Why is signing computed values dangerous?</a></li>
    <li><a href="#the-saml-vulnerability-in-practice">The SAML vulnerability in practice</a></li>
    <li><a href="#why-is-saml-this-way">Why is SAML this way?</a></li>
    <li><a href="#vulnerability-mitigation">Vulnerability mitigation</a></li>
    <li><a href="#how-could-saml-have-been-designed-better">How could SAML have been designed better?</a></li>
    <li><a href="#more-saml-weirdness">More SAML weirdness</a></li>
    <li><a href="#why-is-saml-used-if-it-sucks">Why is SAML used if it sucks?</a></li>
    <li><a href="#action">Action</a></li>
    <li><a href="#ignorance-is-bliss">Ignorance is bliss</a></li>
    <li><a href="#additional-reading">Additional reading</a></li>
  </ul>
</nav>
    </div>
  </span>
</div>

<div class="alert-warning">
	🚨
	<a href="https://www.reuters.com/world/europe/icc-says-may-investigate-possible-war-crimes-after-russian-invasion-ukraine-2022-02-25/">Putin is a war criminal</a>.
	<a href="https://arstechnica.com/science/2022/03/russia-attacked-ukrainian-hospitals-violating-humanitarian-law-who-says/">Russians are bombing hospitals</a>.
	💔🇺🇦
</div>



  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
    

      <h1 class="posttitle" itemprop="name headline">
        SAML is insecure by design
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2021-08-03 12:15:00 &#43;0000 UTC" itemprop="datePublished">2021-08-03</time>
          
        </div>
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/infosec/" rel="tag">infosec</a>
            
        </div>
        
      </div>
    </header>

  
    <div class="content" itemprop="articleBody">
      <h2 id="what-is-saml">What is SAML?</h2>
<blockquote>
<p>Security Assertion Markup Language (SAML) is an open standard for exchanging authentication and
authorization data between parties.</p>
</blockquote>
<p>Source: <a href="https://en.wikipedia.org/wiki/Security_Assertion_Markup_Language">Wikipedia</a></p>
<p>SAML is often used for <a href="https://en.wikipedia.org/wiki/Single_sign-on">single-sign on</a>
(&ldquo;Sign in with Google&rdquo;, &ldquo;Sign in with Twitter&rdquo; etc.).
It means when you want to log in to example.com, example.com
can trust &amp; use an external authentication provider to <em>assert</em> the user&rsquo;s identity for you. SAML
is about communicating these authentication &amp; identity details across organization boundaries (web domains).</p>
<p><img src="saml-overview.png" alt=""></p>
<p>Update: although Google <a href="https://support.google.com/a/answer/6087519">supports SAML</a> use cases,
Google/Facebook primarily use OAuth2 for these &ldquo;Sign in with Google&rdquo; general public authentication flows.
It was my bad for not clarifying that I used these more of <em>example of what Single-sign on means</em>.</p>
<h2 id="why-should-i-care">Why should I care?</h2>
<p>SAML is used in so many places, it probably affects your security too.</p>
<p><a href="https://mattermost.com/blog/securing-xml-implementations-across-the-web/">SAML has recently had catastrophic vulnerabilities</a>
with a really large impact.
For example, if I understood correctly
(I probably did, since the security researcher retweeted <a href="https://twitter.com/joonas_fi/status/1420717822716661762">my reaction</a>)
the Finnish tax authority, most government services and health record systems were vulnerable in such
a way that an attacker could have gone on to snoop people&rsquo;s tax returns, health records and basically
anything government-related that is available online.</p>
<p>It&rsquo;s been largely ignored by the media, perhaps because the vulnerabilities weren&rsquo;t taken
advantage of (or instances of such weren&rsquo;t detected).</p>
<h2 id="why-is-saml-insecure">Why is SAML insecure?</h2>
<p>SAML uses signatures based on computed values.
The practice is inherently insecure and thus SAML as a design is insecure.</p>
<h2 id="why-is-signing-computed-values-dangerous">Why is signing computed values dangerous?</h2>
<p>In summary: once you base your security on some computed property, you can now exploit any flaws,
differences or ambiguity in this computation. The more complex the computation is, the more dangerous it gets.
SAML signature computation is pretty fucking complex.</p>
<p>But let&rsquo;s move on to explain the concept. Let&rsquo;s take a pseudo identity document (actual SAML is XML though):</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">$</span> cat assertion.json
</span></span><span style="display:flex;"><span><span style="color:#aaa">{
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">  &#34;signed_in_user&#34;: &#34;Joonas&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">}
</span></span></span></code></pre></div><p>We can sign<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> the above file just as a bunch of bytes:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">$</span> cat assertion.json | sha1sum
</span></span><span style="display:flex;"><span><span style="color:#aaa">e58dc03a7491f9e5fb2ed664b23d826489c42cc5
</span></span></span></code></pre></div><p>Now if we change the file just a little (I added space before the <code>{</code>).
We notice that the signature changes:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">$</span> cat assertion.json
</span></span><span style="display:flex;"><span><span style="color:#aaa"> {
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">  &#34;signed_in_user&#34;: &#34;Joonas&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">}
</span></span></span><span style="display:flex;"><span><span style="color:#aaa"></span><span style="color:#2c5dcd;font-weight:bold">$</span> cat assertion.json | sha1sum
</span></span><span style="display:flex;"><span><span style="color:#aaa">0bc80a9ee02f611b70319c9fe12b7e504107354a
</span></span></span></code></pre></div><p>This is a very good property, because ideally we want any changes (even those considered meaningless
at JSON level) to the security-critical document (which SAML is) to <strong>produce different signatures</strong>.</p>
<p>This property is known as <a href="https://en.wikipedia.org/wiki/Malleability_(cryptography)">non-malleability</a>.
<a href="https://www.vocabulary.com/dictionary/malleability"><em>Malleability</em> generic definition</a>:</p>
<blockquote>
<p>the quality of something that can be shaped into something else without breaking, like the malleability of clay.</p>
</blockquote>
<p>Us signing the document as a raw byte blob makes this non-malleable, i.e. it can&rsquo;t be shaped without
breaking it. That&rsquo;s a desired behaviour in information security.</p>
<p>SAML is malleable because its signatures are based on computed values:</p>
<table>
<thead>
<tr>
<th>Signature over</th>
<th>Example</th>
<th>Raw content is malleable</th>
<th>Security</th>
</tr>
</thead>
<tbody>
<tr>
<td>Raw bytes</td>
<td>File or message raw content</td>
<td>No</td>
<td>👍</td>
</tr>
<tr>
<td>Computed values</td>
<td>Parsed XML tree content</td>
<td>Yes</td>
<td>👎</td>
</tr>
</tbody>
</table>
<p>To explain by example, let&rsquo;s get back to the JSON example. We&rsquo;ll use <a href="https://stedolan.github.io/jq/">jq</a>
(a JSON transformation utility) to <em>compute</em> something from inside our document:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">$</span> cat assertion.json
</span></span><span style="display:flex;"><span><span style="color:#aaa"> {
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">  &#34;signed_in_user&#34;: &#34;Joonas&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">}
</span></span></span><span style="display:flex;"><span><span style="color:#aaa"></span><span style="color:#fff;background-color:#c00">
</span></span></span><span style="display:flex;"><span><span style="color:#fff;background-color:#c00"></span><span style="color:#2c5dcd;font-weight:bold">$</span> cat assertion.json | jq .
</span></span><span style="display:flex;"><span><span style="color:#aaa">{
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">  &#34;signed_in_user&#34;: &#34;Joonas&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">}
</span></span></span></code></pre></div><p>(<code>jq .</code> means just re-print the whole document)</p>
<p>Notice how piping the file through <code>jq</code> removed the space?
That&rsquo;s because at JSON level the space is not important.
At first sight this doesn&rsquo;t seem interesting, but we&rsquo;re heading to
<a href="https://www.youtube.com/watch?v=siwpn14IE7E">danger zone</a> and fast.</p>
<p><img src="welcome-to-the-danger-zone.jpg" alt=""></p>
<p>Let&rsquo;s sign the computed value:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">$</span> cat assertion.json | jq . | sha1sum
</span></span><span style="display:flex;"><span><span style="color:#aaa">e58dc03a7491f9e5fb2ed664b23d826489c42cc5
</span></span></span></code></pre></div><p>Even though the file still has the space modification, the signature now matches the original
signature (from the file that didn&rsquo;t have the space added).</p>
<p>Why&rsquo;s this dangerous?
Let&rsquo;s change the file again:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">$</span> cat assertion.json
</span></span><span style="display:flex;"><span><span style="color:#aaa">{
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">  &#34;signed_in_user&#34;: &#34;EvilAttacker&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">  &#34;signed_in_user&#34;: &#34;Joonas&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">}
</span></span></span><span style="display:flex;"><span><span style="color:#aaa"></span><span style="color:#fff;background-color:#c00">
</span></span></span><span style="display:flex;"><span><span style="color:#fff;background-color:#c00"></span><span style="color:#2c5dcd;font-weight:bold">$</span> cat assertion.json | jq . | sha1sum
</span></span><span style="display:flex;"><span><span style="color:#aaa">e58dc03a7491f9e5fb2ed664b23d826489c42cc5
</span></span></span><span style="display:flex;"><span><span style="color:#aaa"></span><span style="color:#fff;background-color:#c00">
</span></span></span><span style="display:flex;"><span><span style="color:#fff;background-color:#c00"></span><span style="color:#2c5dcd;font-weight:bold">#</span> the above is because:
</span></span><span style="display:flex;"><span><span style="color:#fff;background-color:#c00">
</span></span></span><span style="display:flex;"><span><span style="color:#fff;background-color:#c00"></span><span style="color:#2c5dcd;font-weight:bold">$</span> cat assertion.json | jq .
</span></span><span style="display:flex;"><span><span style="color:#aaa">{
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">  &#34;signed_in_user&#34;: &#34;Joonas&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">}
</span></span></span></code></pre></div><p>The signature still matches the original file.
This is because <a href="https://stackoverflow.com/a/21833017">duplicate keys are valid JSON</a>, removed upon
processing and most JSON implementations let the last key win.</p>
<p>Now what happens if you have two different pieces of code that process the SAML document and they have
different interpretations/parser behaviour regarding JSON duplicate keys (= message semantic content)?</p>
<p><img src="saml-theoretical-pseudo-example.png" alt=""></p>
<p>An attacker asked the identity provider to sign an assertion for him, but due to SAML malleability he
was able to attack parser differences and tamper the document to still be valid for signature validation
but access data for a different user.</p>
<p>Now I have hopefully explained how malleability and basing signatures on computed / interpreted content
is dangerous.</p>
<h2 id="the-saml-vulnerability-in-practice">The SAML vulnerability in practice</h2>
<p>It is not as straightforward as our JSON example what happened with these SAML vulnerabilities, but
this illustrates the principle of these vulnerabilities and their root cause: signing computed values
and malleability.</p>
<p>The latest vulnerabilities were due to
<a href="https://mattermost.com/blog/securing-xml-implementations-across-the-web/">XML round-trip instability</a>
(see heading &ldquo;What an XML round-trip vulnerability looks like&rdquo;).</p>
<p>In summary the vulnerability arises from when parsing XML -&gt; writing XML produces semantically
different document, i.e. <code>encode(decode(xmlDocument)) != xmlDocument</code>).</p>
<p>I&rsquo;m not 100 % sure but I think since the SAML signature validation needs a XML write step, it went
something like this:</p>
<p><img src="saml-round-trip-vulnerability.png" alt=""></p>
<p>The above would not be an an attack vector if SAML content-to-be-signed was non-malleable, i.e. any change
after the identity provider signs the document would be detected as a signature violation.</p>
<h2 id="why-is-saml-this-way">Why is SAML this way?</h2>
<p>Let&rsquo;s assume in good faith that the SAML designers knew non-malleability is a good property to have
and let&rsquo;s try to guess why they still ended up with a malleable design.</p>
<p>So, let&rsquo;s sign something. When one signs something, one get a signature as output: <code>sign(contentToSign, signingKey) -&gt; signature</code>.</p>
<p>For the signature to be useful, you need to transport the <code>signature</code> along with <code>contentToSign</code> so
that when a consumer reads <code>contentToSign</code> they can verify it with the <code>signature</code>.</p>
<p>Sending this alone would have been easy to keep non-malleable:</p>
<pre tabindex="0"><code>contentToSign
</code></pre><p>But <code>signature</code> is missing. SAML designers probably didn&rsquo;t want to transport the SAML document and
its signature separately (the signature possibly in a HTTP header or URL parameter), so for
convenience they wanted to embed it in the same XML document:</p>
<pre tabindex="0"><code>samlDocument
├── contentToSign
└── signature
</code></pre><p>To be more technically correct, it gets even more YOLO than that. The signature is stored under
<code>contentToSign</code>, so upon the validation process the signature needs to be ignored (<a href="https://github.com/russellhaering/goxmldsig/blob/6f318b2f18251aa66983056c1db7e4eef312103c/validate.go#L252">again more
dangerous complexity</a>)
to not actually include it in <code>contentToSign</code> which would make it an impossible recursive problem:</p>
<pre tabindex="0"><code>samlDocument
└── contentToSign
    └── signature
</code></pre><p>But let&rsquo;s imagine the previous simpler case where the <code>signature</code> was <strong>not</strong> stored inside <code>contentToSign</code>
and get back to the question if we could&rsquo;ve made signature validation byte-based!</p>
<p>The problem is that it is really hard to extract the bytes belonging to <code>contentToSign</code> from inside
the XML message. XML parser APIs to my knowledge don&rsquo;t support this use case. Even if some would, for
SAML to be useful they had to cater to what most XML parser implementations support.</p>
<p>=&gt; When you have <code>samlDocument</code> and you&rsquo;d want to access its sub-tree <code>contentToSign</code>, you only get
XML-level access there, so SAML designers probably didn&rsquo;t think much of it, went 🤷‍♂️ and said
&ldquo;let&rsquo;s sign XML-level data then&rdquo;.</p>
<p>Signing output of an XML parser is really hard, because you&rsquo;re trying to keep signature input stable
from XML parsing output that has parser differences from XML library to library and from language to
language.
So that&rsquo;s why we have <a href="https://www.w3.org/TR/xmldsig-core/">XML dsig</a> which has rules for e.g. sorting
XML attributes in
<a href="https://github.com/russellhaering/goxmldsig/blob/3541f5e554eefd0d2ef501e27544650d62bf5d22/etreeutils/sort.go#L58">some clusterfuck order</a>
in order for SAML implementations to reach some kind of stable consensus on which byte sequence to validate
the signature against.
In the end we always need to match on bytes anyway.
This craziness is known as <em>canonicalization</em> and it transforms something like this this:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">&lt;Example</span>   <span style="color:#2c5dcd;font-style:italic">foo=</span><span style="color:#0c6">&#34;hello&#34;</span>        <span style="color:#2c5dcd;font-style:italic">bar=</span><span style="color:#0c6">&#34;hehehe&#34;</span><span style="color:#2c5dcd;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#2c5dcd;font-weight:bold">&lt;Item&gt;</span>    mooo<span style="color:#2c5dcd;font-weight:bold">&lt;/Item  &gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#2c5dcd;font-weight:bold">&lt;/Example&gt;</span>
</span></span></code></pre></div><p>Into bytes like this (so signature input is stable):</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">&lt;Example</span> <span style="color:#2c5dcd;font-style:italic">bar=</span><span style="color:#0c6">&#34;hehehe&#34;</span> <span style="color:#2c5dcd;font-style:italic">foo=</span><span style="color:#0c6">&#34;hello&#34;</span><span style="color:#2c5dcd;font-weight:bold">&gt;&lt;Item&gt;</span>mooo<span style="color:#2c5dcd;font-weight:bold">&lt;/Item&gt;&lt;/Example&gt;</span>
</span></span></code></pre></div><p>(This is just an example I invented, I&rsquo;m not sure which rules actually exist
<a href="https://github.com/russellhaering/goxmldsig/blob/3541f5e554eefd0d2ef501e27544650d62bf5d22/canonicalize_test.go#L19">but here are some examples</a>.)</p>
<p>Summary: XML sub-trees are hard to sign/validate and there&rsquo;s some horrible things to enable that and
as empirical evidence shows, it&rsquo;s a security nightmare.</p>
<p>I&rsquo;m willing to go on record and say that everything using approaches like these is broken and should
be considered insecure.</p>
<h2 id="vulnerability-mitigation">Vulnerability mitigation</h2>
<p>With Go&rsquo;s vulnerability they had to
<a href="https://github.com/mattermost/xml-roundtrip-validator/tree/master/advisories">fix the round-trip instability in Go&rsquo;s XML stack</a>,
and also as a safety precaution include
<a href="https://github.com/mattermost/xml-roundtrip-validator">round-trip stability validation</a> before
actually processing the XML.</p>
<p>To recap, instead of validating signature from a bunch of bytes, for SAML signature validation we need:</p>
<ul>
<li><a href="https://github.com/dexidp/dex/blob/57640cc7a9f69ae71ac446449ead377974f3c8b9/connector/saml/saml.go#L303">Round-trip stability validation</a>
(= XML parsing + encoding)</li>
<li>XML parsing (again)</li>
<li>XML canonicalization (XML dsig, which is encoding again but with specific complex rules and transforms)</li>
</ul>
<p>If that sounds complex to you, it&rsquo;s because it is.
The more complex something is, the more likely it is to have bugs and security issues.</p>
<h2 id="how-could-saml-have-been-designed-better">How could SAML have been designed better?</h2>
<p>I&rsquo;m an amateur, so take my idea with a grain of salt, but let&rsquo;s try.</p>
<p>(Note: this post is all pseudo code - it&rsquo;s not real SAML. Here&rsquo;s <a href="https://github.com/dexidp/dex/blob/766fc7ad990b51f656e03f03e157ba81da132552/connector/saml/testdata/assertion-signed.xml#L2">a real example</a> if you&rsquo;re interested.)</p>
<p>Instead of doing something like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">&lt;SAMLSignedDocument&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#2c5dcd;font-weight:bold">&lt;SAMLSignature&gt;</span>e58dc03a7491f9e5fb2ed664b23d826489c42cc5<span style="color:#2c5dcd;font-weight:bold">&lt;/SAMLSignature&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#2c5dcd;font-weight:bold">&lt;SAMLContentToSign&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#2c5dcd;font-weight:bold">&lt;Assertion&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#2c5dcd;font-weight:bold">&lt;UserId&gt;</span>Joonas<span style="color:#2c5dcd;font-weight:bold">&lt;/UserId&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#2c5dcd;font-weight:bold">&lt;/Assertion&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#2c5dcd;font-weight:bold">&lt;/SAMLContentToSign&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">&lt;/SAMLSignedDocument&gt;</span>
</span></span></code></pre></div><p>(Which we established is difficult to sign/verify correctly and securely.)</p>
<p>Take the <code>&lt;Assertion&gt;</code> and serialize its sub-tree into bytes and store it as base64 or similar, so we
can transport it as bytes and only XML-parse it once the signature has been verified:</p>
<div class="highlight"><pre tabindex="0" style="color:#4d4d4d;background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">&lt;SAMLSignedDocument&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#2c5dcd;font-weight:bold">&lt;SAMLSignature&gt;</span>e58dc03a7491f9e5fb2ed664b23d826489c42cc5<span style="color:#2c5dcd;font-weight:bold">&lt;/SAMLSignature&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#2c5dcd;font-weight:bold">&lt;SAMLContentToSign&gt;</span>PEFzc2VydGlvbj48VXNlcklkPkpvb25hczwvVXNlcklkPjwvQXNzZXJ0aW9uPgo=<span style="color:#2c5dcd;font-weight:bold">&lt;/SAMLContentToSign&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#2c5dcd;font-weight:bold">&lt;/SAMLSignedDocument&gt;</span>
</span></span></code></pre></div><p>I don&rsquo;t understand much about XML so there may be even prettier ways to transport strings or byte data,
but this should be enough to make a point.</p>
<p>This way they could&rsquo;ve kept the property of everything being inside the one XML document - but you
just need to XML-parse twice:</p>
<ol>
<li>First the outer document, then validate the signature against the byte blob</li>
<li>If the signature matches, only then parse the inner validated document</li>
</ol>
<p>Sure, purists may argue that storing XML inside XML as a string or bytes is ugly (and I agree with you),
but look what we achieved.. The tradeoff is worth it - everything inside <code>SAMLContentToSign</code> is now
non-malleable and you don&rsquo;t need to parse security-critical data before it&rsquo;s validated as coming from
a trusted source. And we don&rsquo;t need the vomit that is &ldquo;XML dsig&rdquo;.</p>
<h2 id="more-saml-weirdness">More SAML weirdness</h2>
<p>SAML requires you to support use cases where the root of the XML document is unsigned, i.e. you only
sign the assertion elements. What is the purpose of allowing attacker-controlled data?
<a href="https://github.com/dexidp/dex/blob/766fc7ad990b51f656e03f03e157ba81da132552/connector/saml/saml.go#L621">You need additional code</a>
to discard the unsafe data in these cases anyway because it&rsquo;d be a catastrophe if you&rsquo;d end up using it.</p>
<h2 id="why-is-saml-used-if-it-sucks">Why is SAML used if it sucks?</h2>
<p>I don&rsquo;t know. I&rsquo;m not aware of a better standard - although I don&rsquo;t know the space well.</p>
<p>OAuth2 exists but is geared towards getting authorization to resources, so it&rsquo;s not an authentication /
identity protocol per se.
<a href="https://www.okta.com/identity-101/saml-vs-oauth/">More on the differences</a>.</p>
<p><a href="https://www.okta.com/identity-101/whats-the-difference-between-oauth-openid-connect-and-saml/">OpenID Connect</a> is also a thing.</p>
<p>My guess is also that once a standard gains traction, it&rsquo;s hard to migrate to a better option
even if one is available, since the previous option already has critical mass (think Whatsapp vs. Signal).</p>
<h2 id="action">Action</h2>
<p>Let&rsquo;s get rid of SAML. 🗑️ Some experts seem to recommend OAuth2 or OpenID Connect:</p>
<ul>
<li><a href="https://twitter.com/pquerna/status/1338517755352387584">https://twitter.com/pquerna/status/1338517755352387584</a></li>
<li><a href="https://github.com/dexidp/dex/discussions/1884">https://github.com/dexidp/dex/discussions/1884</a></li>
</ul>
<p>If a vendor is offering you SAML, ask for alternatives.</p>
<h2 id="ignorance-is-bliss">Ignorance is bliss</h2>
<p>It is my experience that the more you learn about any subject, the more you realize it&rsquo;s all held
together by bubblegum and duct tape.
It&rsquo;s honestly pretty anxiety inducing.</p>
<p><img src="duct-tape-fix.webp" alt=""></p>
<p>When I was researching about this subject, I also noticed that the Finnish government websites&rsquo; security
relies on a single-sign-on component implemented in JavaScript (not even TypeScript) which:</p>
<ul>
<li><a href="https://github.com/vrk-kpa/suomifi-passport-saml/blob/bb18027a6d89ca0b79c70cfdc34dc8fbb48de463/lib/passport-saml/saml.js#L1466">Casually parses security-critical certificates with string replaces</a>.</li>
<li>Mixes Node-style callbacks and explicit Promise usage, i.e. has different flow control styles.</li>
<li><a href="https://github.com/vrk-kpa/suomifi-passport-saml/blob/bb18027a6d89ca0b79c70cfdc34dc8fbb48de463/lib/passport-saml/saml.js#L1342">It&rsquo;s only one forgotten <code>return</code> away from catastrophic flow control bug</a>
where execution accidentally flows to <code>processValidlySignedPostRequest</code> despite signature validation error.
<ul>
<li>But that&rsquo;s what you get when you implement security-critical software with a language where flow
control is not a language feature but a library feature built on top of the language.</li>
<li>TypeScript would at least have given proper async/await flow control with the compiler noticing most of the bugs.</li>
<li>Update: great news, <a href="https://github.com/node-saml/passport-saml">the upstream project</a> the Finnish
gov&rsquo;t fork is based on, had recently been migrated to TypeScript. 🎉</li>
</ul>
</li>
</ul>
<h2 id="additional-reading">Additional reading</h2>
<ul>
<li>
<p><a href="https://mattermost.com/blog/securing-xml-implementations-across-the-web/">https://mattermost.com/blog/securing-xml-implementations-across-the-web/</a> writeup on the round-trip
vulnerability from <a href="https://twitter.com/jupenur">@jupenur</a> (the researcher who found it)</p>
</li>
<li>
<p><a href="https://twitter.com/jupenur/status/1423397250278084610">https://twitter.com/jupenur/status/1423397250278084610</a> <a href="https://twitter.com/jupenur">@jupenur</a>&rsquo;s thread on SAML in general</p>
</li>
<li>
<p><a href="https://news.ycombinator.com/item?id=25424267">https://news.ycombinator.com/item?id=25424267</a> where a maintainer of an affected SAML library echoes some sentiments of my blog post.</p>
</li>
<li>
<p><a href="https://twitter.com/pquerna/status/1349234347266564096">https://twitter.com/pquerna/status/1349234347266564096</a> (pquerna has authored security-related open source like a TOTP library)</p>
</li>
<li>
<p><a href="https://github.com/dexidp/dex/discussions/1884">https://github.com/dexidp/dex/discussions/1884</a> (ericchiang is a security engineer and a major contributor to Dex)</p>
</li>
<li>
<p><a href="https://twitter.com/joonas_fi/status/1339205267637100546">https://twitter.com/joonas_fi/status/1339205267637100546</a></p>
</li>
<li>
<p><a href="https://www.imperialviolet.org/2014/09/26/pkcs1.html">https://www.imperialviolet.org/2014/09/26/pkcs1.html</a> - PKCS#1 has had a lot of issues resulting
from parsing overly-flexible structures first, then validating things based on the computed
result. &ldquo;parsing is dangerous&rdquo;.</p>
</li>
</ul>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><code>sha1sum</code> is not at all a good signing function but it works to demonstrate the principle.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

    </div>
	<div class="post-footer">
		<hr />

		<img src="/signature.png" alt="signature" style="height: 55px;" />

		<p>Thanks for reading! <span style="font-style: normal;">😍</span></p>
		<p>
			If you like my writing, consider following me on
			<a href="https://twitter.com/joonas_fi">Twitter</a>.
		</p>

		<p>
			Stay updated on my blog posts &amp; projects - sign up for
			<a href="https://buttondown.email/joonas">my newsletter</a>. 🚀
			<br />
			<small>
				No spam, unsubscribe any time.
				<a href="/feed.xml">RSS</a> also available.
			</small>
		</p>
	</div>
  </article>

  <hr />

  
<div id="disqus_thread"></div>
<script type="text/javascript">

var disqus_identifier = '\/blog\/2021\/08\/saml-is-insecure-by-design';

(function() {
   if (window.location.hostname.indexOf('.dev.fn61.net') != -1) {
        document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
        return;
    }

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'joonas-fi';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  
  

  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/blog/">Home</a></li>
         
          <li><a href="/blog/today-i-learned/">Today I Learned</a></li>
         
          <li><a href="/blog/about/">About</a></li>
         
          <li><a href="/blog/contact/">Contact</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-saml">What is SAML?</a></li>
    <li><a href="#why-should-i-care">Why should I care?</a></li>
    <li><a href="#why-is-saml-insecure">Why is SAML insecure?</a></li>
    <li><a href="#why-is-signing-computed-values-dangerous">Why is signing computed values dangerous?</a></li>
    <li><a href="#the-saml-vulnerability-in-practice">The SAML vulnerability in practice</a></li>
    <li><a href="#why-is-saml-this-way">Why is SAML this way?</a></li>
    <li><a href="#vulnerability-mitigation">Vulnerability mitigation</a></li>
    <li><a href="#how-could-saml-have-been-designed-better">How could SAML have been designed better?</a></li>
    <li><a href="#more-saml-weirdness">More SAML weirdness</a></li>
    <li><a href="#why-is-saml-used-if-it-sucks">Why is SAML used if it sucks?</a></li>
    <li><a href="#action">Action</a></li>
    <li><a href="#ignorance-is-bliss">Ignorance is bliss</a></li>
    <li><a href="#additional-reading">Additional reading</a></li>
  </ul>
</nav>
    </div>

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&text=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&title=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&is_video=false&description=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=SAML%20is%20insecure%20by%20design&body=Check out this article: https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&title=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&title=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&title=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&title=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-digg fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&name=SAML%20is%20insecure%20by%20design&description=What%20is%20SAML%3f%20Security%20Assertion%20Markup%20Language%20%28SAML%29%20is%20an%20open%20standard%20for%20exchanging%20authentication%20and%20authorization%20data%20between%20parties.%0aSource%3a%20Wikipedia%0aSAML%20is%20often%20used%20for%20single-sign%20on%20%28%26ldquo%3bSign%20in%20with%20Google%26rdquo%3b%2c%20%26ldquo%3bSign%20in%20with%20Twitter%26rdquo%3b%20etc.%29.%20It%20means%20when%20you%20want%20to%20log%20in%20to%20example.com%2c%20example.com%20can%20trust%20%26amp%3b%20use%20an%20external%20authentication%20provider%20to%20assert%20the%20user%26rsquo%3bs%20identity%20for%20you.%20SAML%20is%20about%20communicating%20these%20authentication%20%26amp%3b%20identity%20details%20across%20organization%20boundaries%20%28web%20domains%29.">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2ftunacici.com%2fblog%2f2021%2f08%2fsaml-is-insecure-by-design%2f&t=SAML%20is%20insecure%20by%20design">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2023  joonas.fi 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/blog/">Home</a></li>
         
        <li><a href="/blog/today-i-learned/">Today I Learned</a></li>
         
        <li><a href="/blog/about/">About</a></li>
         
        <li><a href="/blog/contact/">Contact</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>



</html>
